// results.js
import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-database.js";
import { firebaseConfig } from "./config.js";
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

// List of candidate keys
const candidates = ["Farmaajo", "Hassan", "Khaire", "Sharif", "Roble", "Shirdon"];

// Reference to the votes node
const votesRef = ref(db, "votes/");

// Listen for changes in the votes data
onValue(votesRef, (snapshot) => {
  const votes = snapshot.val() || {};

  // Calculate total votes
  let totalVotes = 0;
  candidates.forEach(candidate => {
    totalVotes += votes[candidate] || 0;
  });

  // Update the UI for each candidate
  candidates.forEach(candidate => {
    const count = votes[candidate] || 0;
    const percent = totalVotes > 0 ? (count / totalVotes) * 100 : 0;

    // Update vote count
    const countElement = document.getElementById(`${candidate}Count`);
    if (countElement) {
      countElement.textContent = count;
    }

    // Update progress bar
    const barElement = document.getElementById(`${candidate}Bar`);
    if (barElement) {
      barElement.style.width = `${percent}%`;
    }
  });
});
